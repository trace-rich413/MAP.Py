'"""Configuration parsing and data structures for MAP.Py.\n\nfrom dataclasses import dataclass, field\nfrom typing import List, Optional\nimport yaml\nimport sys\n\n\n@dataclass\nclass Target:\n    """Represents a single recon target IP."""\n    ip: str\n    os: str  # windows | linux | unknown\n    hostname: str = ""\n    notes: str = ""\n\n\n@dataclass\nclass Tool:\n    """Represents a tool configuration entry."""\n    name: str\n    enabled: bool = True\n\n@dataclass\nclass Options:\n    """Global options."""\n    output_root: str = "outputs"\n    timeout_sec: int = 600\n\n@dataclass\nclass Scope:\n    """Complete scope configuration loaded from YAML."""\n    project: str\n    targets: List[Target] = field(default_factory=list)\n    options: Options = field(default_factory=Options)\n    tools: List[Tool] = field(default_factory=list)\n\ndef load_scope(yaml_path: str) -> Scope:\n    """\n    Load and parse scope YAML file.\n    \n    Expected format:\n    project: demo\n    targets:\n      - ip: 10.10.10.10\n        os: windows        # windows | linux | unknown\n        hostname: ""       # optional\n        notes: "Service SME box"\n    options:\n      output_root: outputs\n      timeout_sec: 600\n    tools:\n      - name: nmap_top\n        enabled: true\n      - name: http_probe\n        enabled: true\n      - name: privesc_checklist\n        enabled: true\n    """\n    try:\n        with open(yaml_path, 'r') as f:\n            data = yaml.safe_load(f)\n        \n        if not data:\n            raise ValueError(f"YAML file is empty or invalid: {yaml_path}")\n        \n        project = data.get('project', 'unknown')\n        \n        # Parse targets\n        targets = []\n        for tgt in data.get('targets', []):\n            targets.append(Target(\n                ip=tgt['ip'],\n                os=tgt.get('os', 'unknown'),\n                hostname=tgt.get('hostname', ''),\n                notes=tgt.get('notes', '')\n            ))\n        \n        # Parse options\n        opts_data = data.get('options', {})\n        options = Options(\n            output_root=opts_data.get('output_root', 'outputs'),\n            timeout_sec=opts_data.get('timeout_sec', 600)\n        )\n        \n        # Parse tools\n        tools = []\n        for tool in data.get('tools', []):\n            tools.append(Tool(\n                name=tool['name'],\n                enabled=tool.get('enabled', True)\n            ))\n        \n        return Scope(\n            project=project,\n            targets=targets,\n            options=options,\n            tools=tools\n        )\n    \n    except FileNotFoundError:\n        print(f"ERROR: Scope file not found: {yaml_path}", file=sys.stderr)\n        sys.exit(1)\n    except Exception as e:\n        print(f"ERROR: Failed to parse scope: {e}", file=sys.stderr)\n        sys.exit(1)"